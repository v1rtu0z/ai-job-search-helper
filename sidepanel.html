<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>AI job search helper Side Panel</title>
    <style>
        body {
            font-family: 'Inter', Arial, sans-serif;
            margin: 0;
            padding: 15px;
            background-color: #f4f4f4;
            color: #333;
            padding-bottom: 70px;
        }

        .header-container {
            position: relative;
            height: 24px;
            margin-bottom: 25px;
            background-color: #f4f4f4;
        }

        .icon-button {
            position: absolute;
            width: 24px;
            height: 24px;
            display: flex;
            justify-content: center;
            align-items: center;
            cursor: pointer;
            padding: 0;
            background: none;
            border: none;
            transition: transform 0.2s ease-in-out;
        }

        .icon-button:hover {
            transform: scale(1.3);
            background-color: transparent;
        }

        .icon-button svg {
            width: 24px;
            height: 24px;
            fill: #333;
        }

        #back-btn {
            left: 0;
        }

        #settings-btn {
            right: 0;
        }

        #github-link {
            right: 0;
        }

        hr {
            border: 0;
            height: 1px;
            background-color: #ccc;
            margin: 15px 0;
        }

        .section {
            background-color: #fff;
            padding: 20px;
            border-radius: 8px;
            box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);
            margin-bottom: 15px;
        }

        label {
            display: block;
            margin-bottom: 8px;
            font-weight: bold;
        }

        input[type="text"],
        input[type="file"],
        textarea {
            width: calc(100% - 20px);
            padding: 10px;
            margin-bottom: 15px;
            border: 1px solid #ddd;
            border-radius: 4px;
            box-sizing: border-box;
        }

        #cover-letter-textarea {
            width: 100%;
            height: 400px;
            padding: 10px;
            border: 1px solid #ddd;
            border-radius: 4px;
            box-sizing: border-box;
            font-family: 'Inter', Arial, sans-serif;
            font-size: 14px;
            line-height: 1.5;
            resize: vertical;
        }

        button {
            background-color: #3498db;
            color: white;
            padding: 12px 20px;
            border: none;
            border-radius: 4px;
            cursor: pointer;
            width: 100%;
            font-size: 16px;
            margin-bottom: 10px;
        }

        button:hover {
            background-color: #2980b9;
        }

        #loading-messages {
            text-align: center;
            padding: 2rem;
            border-radius: 12px;
            background-color: #ffffff;
            box-shadow: 0 8px 25px rgba(0, 0, 0, 0.1);
            position: relative;
            width: 90%;
            max-width: 600px;
            height: 150px;
        }

        #loading-messages.hidden {
            display: none;
        }

        .loading-msg {
            font-size: 1.25rem;
            font-weight: 600;
            line-height: 1.5;
            opacity: 0;
            transition: opacity 0.5s ease-in-out;
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            width: 90%;
            text-shadow: 1px 1px 2px rgba(0, 0, 0, 0.05);
        }

        .loading-msg.visible {
            opacity: 1;
        }

        .loading-msg.hidden {
            display: none;
        }

        .hidden {
            display: none;
        }

        .loading-spinner {
            border: 4px solid #f3f3f3;
            border-radius: 50%;
            border-top: 4px solid #3498db;
            width: 30px;
            height: 30px;
            animation: spin 1s linear infinite;
            margin: 20px auto;
        }

        @keyframes spin {
            0% {
                transform: rotate(0deg);
            }
            100% {
                transform: rotate(360deg);
            }
        }

        #instruction-content pre {
            background-color: #f0f0f0;
            border-left: 5px solid #ccc;
            padding: 10px;
            white-space: pre-wrap;
            word-wrap: break-word;
        }

        .canvas-container {
            width: 100%;
            height: 100%;
            overflow: auto;
        }
    </style>
</head>
<body>
<div class="header-container">
    <button id="back-btn" class="icon-button hidden">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24">
            <path d="M20,11V13H8L13.5,18.5L12.08,19.92L4.16,12L12.08,4.08L13.5,5.5L8,11H20Z"/>
        </svg>
    </button>
    <button id="settings-btn" class="icon-button">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24">
            <path d="M12,15.5A3.5,3.5 0 0,1 8.5,12A3.5,3.5 0 0,1 12,8.5A3.5,3.5 0 0,1 15.5,12A3.5,3.5 0 0,1 12,15.5M19.43,12.97C19.47,12.65 19.5,12.33 19.5,12C19.5,11.67 19.47,11.34 19.43,11L21.54,9.37C21.73,9.22 21.78,8.96 21.66,8.74L19.67,5.27C19.55,5.05 19.29,4.96 19.05,5.05L16.56,6.05C16.04,5.66 15.5,5.32 14.87,5.07L14.5,2.42C14.46,2.18 14.25,2 14,2H10C9.75,2 9.54,2.18 9.5,2.42L9.13,5.07C8.5,5.32 7.96,5.66 7.44,6.05L4.95,5.05C4.71,4.96 4.45,5.05 4.33,5.27L2.34,8.74C2.21,8.96 2.27,9.22 2.46,9.37L4.57,11C4.53,11.34 4.5,11.67 4.5,12C4.5,12.33 4.53,12.65 4.57,12.97L2.46,14.63C2.27,14.78 2.21,15.04 2.34,15.26L4.33,18.73C4.45,18.95 4.71,19.03 4.95,18.95L7.44,17.94C7.96,18.34 8.5,18.68 9.13,18.93L9.5,21.58C9.54,21.82 9.75,22 10,22H14C14.25,22 14.46,21.82 14.5,21.58L14.87,18.93C15.5,18.67 16.04,18.34 16.56,17.94L19.05,18.95C19.29,19.03 19.55,18.95 19.67,18.73L21.66,15.26C21.78,15.04 21.73,14.78 21.54,14.63L19.43,12.97Z"/>
        </svg>
    </button>
    <a id="github-link" class="icon-button hidden" href="https://github.com/v1rtu0z/ai-job-search-helper"
       target="_blank" rel="noopener noreferrer">
        <svg role="img" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg">
            <title>GitHub</title>
            <path d="M12 .297c-6.63 0-12 5.373-12 12 0 5.303 3.438 9.8 8.205 11.385.6.113.82-.258.82-.577 0-.285-.01-1.04-.015-2.04-3.338.724-4.042-1.61-4.042-1.61-.546-1.387-1.333-1.756-1.333-1.756-1.089-.745.083-.729.083-.729 1.205.084 1.838 1.236 1.838 1.236 1.07 1.835 2.809 1.305 3.495.998.108-.777.418-1.305.762-1.604-2.665-.3-5.466-1.332-5.466-5.93 0-1.31.465-2.38 1.235-3.22-.135-.303-.54-1.523.105-3.176 0 0 1.005-.322 3.301 1.23.957-.266 1.983-.399 3.003-.404 1.02.005 2.046.138 3.006.404 2.296-1.552 3.297-1.23 3.297-1.23.645 1.653.24 2.873.105 3.176.77.84 1.235 1.91 1.235 3.22 0 4.61-2.805 5.624-5.475 5.923.42.36.81 1.096.81 2.22 0 1.606-.015 2.897-.015 3.286 0 .315.21.69.825.577C20.565 22.092 24 17.592 24 12.297c0-6.627-5.373-12-12-12"/>
        </svg>
    </a>
</div>
<hr>

<div id="instruction-display" class="view-section">
    <h3>Instructions</h3>
    <p>To begin, <strong>select a job description on any webpage</strong>.</p>
    <p>Once the text is highlighted, choose one of the following options to analyze it:</p>
    <ul>
        <li>
            <p>
                <strong>Right-click</strong> on the selected text and choose "<strong>Analyze Job Posting Fit</strong>"
                from the context menu.
            </p>
        </li>
        <li>
            <p>
                Use the keyboard shortcut <strong>Ctrl+B</strong> (or <strong>Cmd+B</strong> on Mac) by default, but you
                can change this in Chrome extension settings.
            </p>
        </li>
    </ul>
    <p>Your resume, additional details, and API key must be saved in the settings for this to work.</p>
    <div id="instruction-content">
        <div id="search-query-section" class="section hidden">
            <div class="search-query-header" style="position: relative;">
                <button id="refresh-query-btn" class="icon-button" style="right: 3%; position: absolute;">
                    <svg xmlns="http://www.w3.org/2000/svg" width="256" height="256" viewBox="0 0 256 256"
                         xml:space="preserve">
                <g style="stroke: none; stroke-width: 0; stroke-dasharray: none; stroke-linecap: butt; stroke-linejoin: miter; stroke-miterlimit: 10; fill: none; fill-rule: nonzero; opacity: 1;"
                   transform="translate(1.4065934065934016 1.4065934065934016) scale(2.81 2.81)">
                    <path d="M 81.521 31.109 c -0.86 -1.73 -2.959 -2.438 -4.692 -1.575 c -1.73 0.86 -2.436 2.961 -1.575 4.692 c 2.329 4.685 3.51 9.734 3.51 15.01 C 78.764 67.854 63.617 83 45 83 S 11.236 67.854 11.236 49.236 c 0 -16.222 11.501 -29.805 26.776 -33.033 l -3.129 4.739 c -1.065 1.613 -0.62 3.784 0.992 4.85 c 0.594 0.392 1.264 0.579 1.926 0.579 c 1.136 0 2.251 -0.553 2.924 -1.571 l 7.176 -10.87 c 0.001 -0.001 0.001 -0.002 0.002 -0.003 l 0.018 -0.027 c 0.063 -0.096 0.106 -0.199 0.159 -0.299 c 0.049 -0.093 0.108 -0.181 0.149 -0.279 c 0.087 -0.207 0.152 -0.419 0.197 -0.634 c 0.009 -0.041 0.008 -0.085 0.015 -0.126 c 0.031 -0.182 0.053 -0.364 0.055 -0.547 c 0 -0.014 0.004 -0.028 0.004 -0.042 c 0 -0.066 -0.016 -0.128 -0.019 -0.193 c -0.008 -0.145 -0.018 -0.288 -0.043 -0.431 c -0.018 -0.097 -0.045 -0.189 -0.071 -0.283 c -0.032 -0.118 -0.065 -0.236 -0.109 -0.35 c -0.037 -0.095 -0.081 -0.185 -0.125 -0.276 c -0.052 -0.107 -0.107 -0.211 -0.17 -0.313 c -0.054 -0.087 -0.114 -0.168 -0.175 -0.25 c -0.07 -0.093 -0.143 -0.183 -0.223 -0.27 c -0.074 -0.08 -0.153 -0.155 -0.234 -0.228 c -0.047 -0.042 -0.085 -0.092 -0.135 -0.132 L 36.679 0.775 c -1.503 -1.213 -3.708 -0.977 -4.921 0.53 c -1.213 1.505 -0.976 3.709 0.53 4.921 l 3.972 3.2 C 17.97 13.438 4.236 29.759 4.236 49.236 C 4.236 71.714 22.522 90 45 90 s 40.764 -18.286 40.764 -40.764 C 85.764 42.87 84.337 36.772 81.521 31.109 z"
                          style="stroke: none; stroke-width: 1; stroke-dasharray: none; stroke-linecap: butt; stroke-linejoin: miter; stroke-miterlimit: 10; fill: rgb(0,0,0); fill-rule: nonzero; opacity: 1;"
                          transform=" matrix(1 0 0 1 0 0) " stroke-linecap="round"/>
                </g>
            </svg>
                </button>
                <h3>Your Personalized Search Query</h3>
            </div>
            <p>Here's a personalized LinkedIn search query, copy and paste it into the LinkedIn job search bar to get
                you started:</p>
            <pre><code id="search-query-code"></code></pre>
            <p><strong>Tip:</strong> Extending the query with more specific terms will yield better results!</p>
        </div>
    </div>
</div>

<div id="markdown-output-section" class="section hidden">
    <div id="markdown-content"></div>
    <div id="resume-preview-container" class="canvas-container hidden"></div>
    <label for="cover-letter-textarea" id="cover-letter-textarea-title">
        Cover letter
    </label>
    <textarea id="cover-letter-textarea" class="hidden"></textarea>
    <button id="tailor-resume-btn" class="hidden">Tailor Resume</button>
    <button id="generate-cover-letter-btn" class="hidden">Draft a Cover Letter</button>
    <button id="download-tailored-resume-btn" class="hidden">Download Tailored Resume</button>
    <button id="download-cover-letter-btn" class="hidden">Download Cover Letter</button>
    <button id="retry-btn" class="hidden">Retry</button>
</div>

<div id="loading-spinner-section" class="section hidden">
    <div class="loading-spinner"></div>
    <p id="loading-spinner-title" style="text-align: center;"></p>
    <div id="loading-messages" style="text-align: center;" class="hidden">
        <div
                class="loading-msg hidden"
                id="loading-msg-bmc"
                data-id="bmc"
                data-kinds="analyze cover-letter resume"
                data-freeze="true"
        >
            <p> If this helps you land the job, please consider supporting the project:</p>
            <div style="display: flex; justify-content: center; margin-top: 10px;">
                <a href="https://buymeacoffee.com/v1rtu0z96" target="_blank" rel="noopener noreferrer"
                   style="display: flex; align-items: center; justify-content: flex-start; padding: 10px 20px; text-decoration: none; color: #000; background-color: #FFDD00; border-radius: 50px; font-weight: bold; font-size: 16px; box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1); width: 160px; overflow: hidden; white-space: nowrap;">
                    <img src="https://www.buymeacoffee.com/assets/img/BMC-btn-logo.svg" alt="Buy Me a Coffee"
                         style="height: 25px; flex-shrink: 0;">
                    <span style="margin-left: 5px; opacity: 1;">Buy me a coffee</span>
                </a>
            </div>
        </div>

        <!--        TODO: Write to jetbrains and ask for sponsorship in order to display this message-->
        <!--        <div-->
        <!--                class="loading-msg hidden"-->
        <!--                id="loading-msg-webstorm"-->
        <!--                data-id="webstorm"-->
        <!--                data-kinds="analyze cover-letter resume"-->
        <!--        >-->
        <!--            <p>This extension was developed using-->
        <!--                <a href="https://www.jetbrains.com/webstorm/" target="_blank" rel="noopener noreferrer">JetBrains-->
        <!--                    WebStorm</a>.-->
        <!--                It's an awesome IDE for web development!-->
        <!--            </p>-->
        <!--        </div>-->

        <div
                class="loading-msg hidden"
                id="loading-msg-feedback"
                data-id="feedback"
                data-kinds="analyze cover-letter resume"
        >
            <p>Got feedback? I'd be happy to hear it. Send me a message:</p>
            <div style="display: flex; justify-content: center; margin-top: 10px;">
                <a href="mailto:nikolamandic1996@gmail.com?subject=AI%20Job%20Search%20Helper%20Feedback"
                   style="display: flex; align-items: center; text-decoration: none; color: #333; background-color: #f1f1f1; border: 1px solid #ddd; border-radius: 50px; padding: 10px 20px; font-weight: bold; font-size: 16px; box-shadow: 0 2px 4px rgba(0,0,0,0.1);">
                    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"
                         style="height: 25px; width: 25px; fill: #333;">
                        <path d="M22 6c0-1.1-.9-2-2-2H4c-1.1 0-2 .9-2 2v12c0 1.1.9 2 2 2h16c1.1 0 2-.9 2-2V6zm-2 0l-8 5-8-5h16zm0 12H4V8l8 5 8-5v10z"/>
                    </svg>
                    <span style="margin-left: 10px;">Send feedback</span>
                </a>
            </div>
        </div>

        <div
                class="loading-msg hidden"
                id="loading-msg-llamaindex"
                data-id="llamaindex"
                data-kinds="analyze cover-letter resume"
        >
            This extension wouldn't have been possible without <a
                href="https://github.com/run-llama/LlamaIndexTS" target="_blank"
                rel="noopener noreferrer">LlamaIndexTS</a>, an amazing open source project.
        </div>

        <div
                class="loading-msg hidden"
                id="loading-msg-pdfjs"
                data-id="pdfjs"
                data-kinds="analyze cover-letter resume"
        >
            This extension wouldn't have been possible without <a href="https://github.com/mozilla/pdf.js"
                                                                              target="_blank"
                                                                              rel="noopener noreferrer">pdf.js</a>, an
            amazing open source project.
        </div>

        <div
                class="loading-msg hidden"
                id="loading-msg-rendercv"
                data-id="rendercv"
                data-kinds="analyze cover-letter resume"
        >
            This extension wouldn't have been possible without <a
                href="https://github.com/rendercv/rendercv" target="_blank" rel="noopener noreferrer">renderCV</a>, an
            amazing open source project.
        </div>

        <div
                class="loading-msg hidden"
                id="loading-msg-javascript"
                data-id="javascript"
                data-kinds="analyze cover-letter resume"
        >
            <p>Powered in part by JavaScript, an open-source standard that
                <a href="https://javascript.tm/" target="_blank" rel="noopener noreferrer"> Oracle should definitely
                    release.</a>
            </p>
        </div>
        <div
                class="loading-msg hidden"
                id="loading-msg-source"
                data-id="source"
                data-kinds="analyze cover-letter resume"
        >
            <p>This project is open source!</p>
            <p>
                <a href="https://github.com/v1rtu0z/ai-job-search-helper" target="_blank" rel="noopener noreferrer">Check
                    out the code on GitHub.</a>
            </p>
        </div>
    </div>
</div>

<div id="settings-view" class="hidden">
    <div id="user-details-section" class="section">
        <p>Let the AI know a bit about you:</p>
        <label for="resume-file">Upload your Resume (PDF or TXT):</label>
        <div id="resume-file-name" style="margin-bottom: 10px;"></div>
        <!--               todo: remove the placeholder-->
        <input type="file" id="resume-file" accept=".pdf,.txt">
        <label for="additional-details">Additional Details:</label>
        <textarea id="additional-details" rows="4"
                  placeholder="Information like preferred roles, industries, locations, salary ranges..."></textarea>
        <p id="user-details-message" style="color: green; margin-top: 10px;"></p>
    </div>

    <div id="api-key-section" class="section">
        <p>You can set up your free tier key
            <a href="https://aistudio.google.com/app/apikey" target="_blank" rel="noopener noreferrer">here</a>.
        </p>
        <p>
            To learn more about what an API key is, click
            <a href="https://en.wikipedia.org/wiki/API_key" target="_blank" rel="noopener noreferrer">here</a>.
        </p>
        <label for="google-api-key">Google API Key:</label>
        <input type="text" id="google-api-key" placeholder="this value is already pre-set, only change it if you're facing issues">
        <p id="api-key-message" style="color: red; margin-top: 10px;"></p>

        <button id="save-all-settings-btn">Save All Settings</button>
    </div>
</div>

<script src="js/showdown.min.js"></script>
<script type="module" src="js/pdf.mjs"></script>
<script src="js/sidepanel.js"></script>
</body>
</html>